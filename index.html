<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Game of Life - Infinite</title>

    <!-- PWA & Mobile -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#050505">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Game of Life">
    <link rel="apple-touch-icon" href="icon.svg">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <canvas id="gridCanvas"></canvas>
    
    <div id="ui-layer">
        <div class="controls">
            <div class="control-group">
                <button id="playPauseBtn" title="Play/Pause (Space)">
                    <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>
                </button>
            </div>

            <div class="separator"></div>

            <div class="control-group">
                <button id="pencilBtn" class="active" title="Pencil (D)">
                    <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                </button>
                <button id="eraserBtn" title="Eraser (E)">
                    <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.78-.78 2.05 0 2.83L5.17 20.17c.79.79 2.05.79 2.83 0l11.14-11.14c.78-.78.78-2.05 0-2.83l-2.58-2.58C16.16 3.2 15.65 3 15.14 3zM5 19l-1.41-1.41L13.17 8 16 10.83 5 19z"/></svg>
                </button>
                <button id="selectBtn" title="Select (S)">
                    <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M3 5h2V3c-1.1 0-2 .9-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2c0-1.1-.9-2-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm8 0h-2v2h2V3zm2 8h2v-2h-2v2zm0-4h2V5h-2v2zm0 12h2c0 1.1-.9 2-2 2v-2zm0-4h2v-2h-2v2zm-4 4h-2v2h2v-2zm-4 0H9v2h2v-2zm-2 0H5v2h2v-2z"/></svg>
                </button>
                <button id="handBtn" title="Pan (H)">
                    <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M23 5.5V20c0 2.2-1.8 4-4 4h-7.3c-1.08 0-2.1-.43-2.85-1.19L1 14.83s1.26-1.23 1.3-1.25c.22-.19.49-.29.79-.29.22 0 .42.06.6.16.04.01 4.31 2.46 4.31 2.46V4c0-.83.67-1.5 1.5-1.5S11 3.17 11 4v7h1V1.5c0-.83.67-1.5 1.5-1.5S15 .67 15 1.5V11h1V2.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5V11h1V5.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5z"/></svg>
                </button>
            </div>
            
            <div class="separator"></div>

            <div class="control-group">
                <button id="patternBtn" title="Patterns (P)">
                    <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
                </button>
                <button id="randomBtn" title="Random Fill">
                    <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/></svg>
                </button>
                <button id="clearBtn" title="Clear All">
                    <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>

            <div class="separator"></div>

            <div class="slider-container">
                <label for="speedRange">SPEED</label>
                <input type="range" id="speedRange" min="1" max="60" value="30">
            </div>

            <div class="separator"></div>

            <div class="info">
                <div class="stat"><span class="label">POP</span> <span id="population" class="value">0</span></div>
                <div class="stat"><span class="label">GEN</span> <span id="generation" class="value">0</span></div>
            </div>
        </div>
        <div class="hint">Left click: Active Tool • Right click: Pan • Scroll: Zoom</div>
    </div>

    <div id="context-menu" class="context-menu">
        <div id="ctx-selection-group" style="display: none;">
            <div class="menu-item" id="ctx-duplicate">Duplicate <span class="shortcut">Ctrl+Drag</span></div>
            <div class="menu-item" id="ctx-delete-sel">Delete Selection <span class="shortcut">Del</span></div>
            <div class="separator"></div>
        </div>
        
        <div class="menu-item" id="ctx-center">Center View</div>
        <div class="menu-item" id="ctx-random">Random Fill</div>
        <div class="menu-item" id="ctx-clear">Clear All</div>
        
        <div class="separator"></div>
        <div class="menu-item" id="ctx-cancel">Cancel</div>
    </div>

    <!-- Modal pour les modèles -->
    <div id="patternModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Pattern Library</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="categories-list" id="categoriesList">
                    <!-- Boutons de catégories générés par JS -->
                </div>
                <div class="patterns-grid" id="patternsGrid">
                    <!-- Cartes de modèles générées par JS -->
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(reg => console.log('Service Worker registered', reg))
                    .catch(err => console.log('Service Worker registration failed', err));
            });
        }
    </script>
</body>
</html>